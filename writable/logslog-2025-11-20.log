DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
CRITICAL - 2025-11-20 23:31:06 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:31:06 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:31:06 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:31:06 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:31:06 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:31:06 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:31:06 --> Class list results count: 215
DEBUG - 2025-11-20 23:31:06 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:31:06 --> Class list results count: 215
DEBUG - 2025-11-20 23:31:06 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:31:07 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
CRITICAL - 2025-11-20 23:32:35 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/StudentFromClassList]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:32:35 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:32:52 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:32:52 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/StudentFromClassList]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
DEBUG - 2025-11-20 23:32:59 --> AuthFilter: Route = common/settingList/\App\Controllers\Common::settingList
DEBUG - 2025-11-20 23:32:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:32:59 --> AuthFilter: Token validated successfully for route: common/settingList/\App\Controllers\Common::settingList
WARNING - 2025-11-20 23:32:59 --> [DEPRECATED] Creation of dynamic property App\Controllers\School::$allowedRoutes is deprecated in APPPATH/Controllers/School.php on line 95.
 1 APPPATH/Controllers/School.php(39): App\Controllers\School->verifyAuthUrl()
 2 SYSTEMPATH/CodeIgniter.php(904): App\Controllers\School->initController(Object(CodeIgniter\HTTP\IncomingRequest), Object(CodeIgniter\HTTP\Response), Object(CodeIgniter\Log\Logger))
 3 SYSTEMPATH/CodeIgniter.php(498): CodeIgniter\CodeIgniter->createController()
 4 SYSTEMPATH/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
 5 SYSTEMPATH/Boot.php(334): CodeIgniter\CodeIgniter->run()
 6 SYSTEMPATH/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
 7 FCPATH/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
WARNING - 2025-11-20 23:32:59 --> [DEPRECATED] Creation of dynamic property App\Controllers\School::$excludeRoutes is deprecated in APPPATH/Controllers/School.php on line 153.
 1 APPPATH/Controllers/School.php(42): App\Controllers\School->excludefunction()
 2 SYSTEMPATH/CodeIgniter.php(904): App\Controllers\School->initController(Object(CodeIgniter\HTTP\IncomingRequest), Object(CodeIgniter\HTTP\Response), Object(CodeIgniter\Log\Logger))
 3 SYSTEMPATH/CodeIgniter.php(498): CodeIgniter\CodeIgniter->createController()
 4 SYSTEMPATH/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
 5 SYSTEMPATH/Boot.php(334): CodeIgniter\CodeIgniter->run()
 6 SYSTEMPATH/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
 7 FCPATH/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
DEBUG - 2025-11-20 23:33:00 --> AuthFilter: Route = api/dashboard/\App\Controllers\Admin\Dashboard::getDashboard
DEBUG - 2025-11-20 23:33:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:33:00 --> AuthFilter: Token validated successfully for route: api/dashboard/\App\Controllers\Admin\Dashboard::getDashboard
CRITICAL - 2025-11-20 23:33:04 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/StudentFromClassList]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:33:04 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 157.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:34:39 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 163.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:34:39 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/StudentFromClassList]
in APPPATH/Controllers/Student.php on line 163.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:35:12 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/list]
in APPPATH/Controllers/Student.php on line 163.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
CRITICAL - 2025-11-20 23:35:12 --> ErrorException: Declaration of App\Controllers\Student::update(): CodeIgniter\HTTP\ResponseInterface must be compatible with CodeIgniter\RESTful\ResourceController::update($id = null)
[Method: POST, Route: student/StudentFromClassList]
in APPPATH/Controllers/Student.php on line 163.
 1 [internal function]: CodeIgniter\Debug\Exceptions->shutdownHandler()
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:36:19 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:36:19 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:36:19 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:36:19 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:36:19 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:36:19 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763681579}
DEBUG - 2025-11-20 23:36:19 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:36:19 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:36:19 --> ðŸ“ Guardians::list - No guardians found for student: 2477
DEBUG - 2025-11-20 23:36:19 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:36:19 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:36:19 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:36:19 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:19 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:36:19 --> Class list results count: 215
DEBUG - 2025-11-20 23:36:19 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:36:19 --> Class list results count: 215
DEBUG - 2025-11-20 23:36:19 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:36:23 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:36:23 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:23 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Route = student/update/\App\Controllers\Student::update
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token validated successfully for route: student/update/\App\Controllers\Student::update
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:36:39 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:36:39 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:36:39 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763681579}
DEBUG - 2025-11-20 23:36:39 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:36:39 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:36:39 --> ðŸ“ Guardians::list - No guardians found for student: 2477
DEBUG - 2025-11-20 23:36:40 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:36:40 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:36:40 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:36:40 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:36:40 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:36:40 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:36:40 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Route = crm/guardians/save/\App\Controllers\Admin\Guardians::save
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Token validated successfully for route: crm/guardians/save/\App\Controllers\Admin\Guardians::save
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Route = crm/guardians/assign/\App\Controllers\Admin\Guardians::assign
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:37:11 --> AuthFilter: Token validated successfully for route: crm/guardians/assign/\App\Controllers\Admin\Guardians::assign
WARNING - 2025-11-20 23:37:11 --> âš ï¸ Guardians::assign - Permission denied: user 49 tried to assign to student 2477
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Route = common/settingList/\App\Controllers\Common::settingList
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Token validated successfully for route: common/settingList/\App\Controllers\Common::settingList
WARNING - 2025-11-20 23:40:50 --> [DEPRECATED] Creation of dynamic property App\Controllers\School::$allowedRoutes is deprecated in APPPATH/Controllers/School.php on line 95.
 1 APPPATH/Controllers/School.php(39): App\Controllers\School->verifyAuthUrl()
 2 SYSTEMPATH/CodeIgniter.php(904): App\Controllers\School->initController(Object(CodeIgniter\HTTP\IncomingRequest), Object(CodeIgniter\HTTP\Response), Object(CodeIgniter\Log\Logger))
 3 SYSTEMPATH/CodeIgniter.php(498): CodeIgniter\CodeIgniter->createController()
 4 SYSTEMPATH/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
 5 SYSTEMPATH/Boot.php(334): CodeIgniter\CodeIgniter->run()
 6 SYSTEMPATH/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
 7 FCPATH/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
WARNING - 2025-11-20 23:40:50 --> [DEPRECATED] Creation of dynamic property App\Controllers\School::$excludeRoutes is deprecated in APPPATH/Controllers/School.php on line 153.
 1 APPPATH/Controllers/School.php(42): App\Controllers\School->excludefunction()
 2 SYSTEMPATH/CodeIgniter.php(904): App\Controllers\School->initController(Object(CodeIgniter\HTTP\IncomingRequest), Object(CodeIgniter\HTTP\Response), Object(CodeIgniter\Log\Logger))
 3 SYSTEMPATH/CodeIgniter.php(498): CodeIgniter\CodeIgniter->createController()
 4 SYSTEMPATH/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
 5 SYSTEMPATH/Boot.php(334): CodeIgniter\CodeIgniter->run()
 6 SYSTEMPATH/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
 7 FCPATH/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Route = api/dashboard/\App\Controllers\Admin\Dashboard::getDashboard
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:50 --> AuthFilter: Token validated successfully for route: api/dashboard/\App\Controllers\Admin\Dashboard::getDashboard
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:40:56 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:40:56 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:40:56 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:40:56 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:40:56 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:40:56 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:40:56 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:40:56 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:40:56 --> ðŸ“ Guardians::list - No guardians found for student: 2477
DEBUG - 2025-11-20 23:40:56 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:40:56 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:40:56 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:40:56 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:56 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:40:56 --> Class list results count: 215
DEBUG - 2025-11-20 23:40:56 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:40:56 --> Class list results count: 215
DEBUG - 2025-11-20 23:40:56 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:40:59 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:40:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:40:59 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:45:34 --> AuthFilter: Route = crm/guardians/save/\App\Controllers\Admin\Guardians::save
DEBUG - 2025-11-20 23:45:34 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:45:34 --> AuthFilter: Token validated successfully for route: crm/guardians/save/\App\Controllers\Admin\Guardians::save
ERROR - 2025-11-20 23:45:34 --> mysqli_sql_exception: Duplicate entry '2-2134234441' for key 'ux_guardians_school_phone' in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('INSERT INTO `gu...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('INSERT INTO `gu...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('INSERT INTO `gu...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(2345): CodeIgniter\Database\BaseConnection->query('INSERT INTO `gu...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(394): CodeIgniter\Database\BaseBuilder->insert()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(839): CodeIgniter\Model->doInsert(Array)
#6 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(800): CodeIgniter\BaseModel->insert(Array, true)
#7 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(210): CodeIgniter\Model->insert(Array, true)
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->save()
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#12 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#13 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#14 {main}
DEBUG - 2025-11-20 23:46:10 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:46:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:10 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:46:22 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:22 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:28 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:28 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:28 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:32 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:46:32 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:32 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:46:37 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:46:37 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:37 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:46:38 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:38 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:38 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:46 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:46 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:46 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:47 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:47 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:47 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:46:51 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:46:51 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:46:51 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:46:51 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:51 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:46:52 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:46:52 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:46:52 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:46:52 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:46:52 --> ðŸ“ Guardians::list - No guardians found for student: 2477
DEBUG - 2025-11-20 23:46:52 --> Class list results count: 215
DEBUG - 2025-11-20 23:46:52 --> Class list results count: 215
DEBUG - 2025-11-20 23:46:52 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:46:52 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:46:52 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:46:52 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:46:52 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:46:52 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:52 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:46:53 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:46:53 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:46:53 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Route = crm/guardians/save/\App\Controllers\Admin\Guardians::save
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token validated successfully for route: crm/guardians/save/\App\Controllers\Admin\Guardians::save
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Route = crm/guardians/assign/\App\Controllers\Admin\Guardians::assign
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token validated successfully for route: crm/guardians/assign/\App\Controllers\Admin\Guardians::assign
DEBUG - 2025-11-20 23:47:00 --> âœ… Guardians::assign - Guardian 11 assigned to 1 student(s)
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:00 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:00 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:00 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:47:00 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:47:00 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:47:00 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:47:00 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:47:00 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:47:03 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:47:03 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:03 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:47:05 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:47:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:05 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:47:12 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:47:12 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:12 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:47:46 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:47:46 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:46 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:47:47 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:47:47 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:47 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:54 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:47:54 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:54 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:47:54 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:47:54 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:54 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:47:54 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:47:54 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:47:54 --> Class list results count: 215
DEBUG - 2025-11-20 23:47:54 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:47:54 --> Class list results count: 215
DEBUG - 2025-11-20 23:47:54 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
ERROR - 2025-11-20 23:47:54 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:47:54 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:47:54 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:47:54 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:47:54 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:47:54 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:47:54 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:54 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:47:55 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:47:55 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:55 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:47:59 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:47:59 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:59 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:47:59 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:47:59 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:47:59 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:47:59 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:47:59 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:47:59 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:47:59 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:47:59 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:47:59 --> Class list results count: 215
DEBUG - 2025-11-20 23:47:59 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:47:59 --> Class list results count: 215
DEBUG - 2025-11-20 23:47:59 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:47:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:00 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:48:00 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:48:00 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:48:00 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:00 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:01 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:01 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:10 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:10 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:10 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:10 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:10 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:11 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:11 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:48:11 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:48:11 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:48:11 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:48:11 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:48:11 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:48:11 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:11 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:11 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:11 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:11 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:48:11 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:48:11 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:48:11 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:11 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:27 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:27 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:29 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:48:29 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:29 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:30 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:35 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:35 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:35 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:35 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:35 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:36 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:36 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:48:36 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:48:36 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:48:36 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:48:36 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:48:36 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
ERROR - 2025-11-20 23:48:36 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
DEBUG - 2025-11-20 23:48:36 --> Found 3 transactions for student_id=2477 after filtering
WARNING - 2025-11-20 23:48:36 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:48:36 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:48:36 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:36 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:36 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:36 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:36 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:37 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:39 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Route = admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token validated successfully for route: admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:40 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:40 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:40 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:40 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:40 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:48:51 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:48:51 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:51 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:51 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:51 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:48:52 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:52 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:48:52 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:48:52 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:48:52 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
DEBUG - 2025-11-20 23:48:52 --> Filtering transactions by school_id=2 for student_id=2477
WARNING - 2025-11-20 23:48:52 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:48:52 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:48:52 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:48:52 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:48:52 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:52 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:52 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:52 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:52 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:52 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:48:53 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:53 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:53 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:48:54 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:48:54 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:54 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:48:55 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:48:55 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:55 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Route = admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token validated successfully for route: admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:48:56 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:48:56 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:48:56 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:48:56 --> Class list results count: 215
DEBUG - 2025-11-20 23:48:56 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:49:01 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:49:01 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:49:01 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:49:01 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:49:01 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:49:01 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:49:01 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:49:01 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:49:01 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:49:01 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:49:01 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:49:01 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:49:01 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:49:01 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:49:01 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:01 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:49:01 --> Class list results count: 215
DEBUG - 2025-11-20 23:49:01 --> Class list results count: 215
DEBUG - 2025-11-20 23:49:01 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:49:01 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:49:02 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:22 --> AuthFilter: Route = admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:50:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:22 --> AuthFilter: Token validated successfully for route: admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:50:22 --> CourseFeePlanModel::getFeeForCourse - course_id=8, school_id=2, fee_term=2, billing_cycle_days=30
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Route = admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token validated successfully for route: admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:50:24 --> CourseFeePlanModel::getFeeForCourse - course_id=8, school_id=2, fee_term=2, billing_cycle_days=30
WARNING - 2025-11-20 23:50:24 --> BillingScheduler::seedSchedule - Table t_billing_schedule does not exist. Skipping billing schedule creation.
WARNING - 2025-11-20 23:50:24 --> Failed to seed billing schedule: Billing schedule table not available
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:24 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:50:24 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:50:24 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:50:24 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:50:24 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:28 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Route = admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token validated successfully for route: admin/student-class/remove/\App\Controllers\Admin\StudentClass::remove
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:50:31 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:50:31 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:31 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:50:31 --> Class list results count: 215
DEBUG - 2025-11-20 23:50:31 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:50:38 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:50:38 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:50:38 --> Class list results count: 215
DEBUG - 2025-11-20 23:50:38 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:48 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:50:48 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:50:48 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:50:48 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:50:48 --> Class list results count: 215
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:48 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:50:48 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:50:48 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:50:48 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:50:48 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
WARNING - 2025-11-20 23:50:48 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:50:48 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:50:48 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:50:48 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:50:48 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:50:48 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:50:48 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:50:49 --> Class list results count: 215
DEBUG - 2025-11-20 23:50:49 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:50 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:55 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:50:55 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:55 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:50:59 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:51:00 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:00 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:00 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:03 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:51:03 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:03 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:07 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:51:10 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:51:10 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:10 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:51:10 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:51:10 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:51:11 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:51:11 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:51:11 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:51:11 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:51:11 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
WARNING - 2025-11-20 23:51:11 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:51:11 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:51:11 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:51:11 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:51:11 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:51:11 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:51:11 --> Class list results count: 215
DEBUG - 2025-11-20 23:51:11 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:51:11 --> Class list results count: 215
DEBUG - 2025-11-20 23:51:11 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:11 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:51:12 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:51:19 --> AuthFilter: Route = admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:51:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:19 --> AuthFilter: Token validated successfully for route: admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:51:19 --> CourseFeePlanModel::getFeeForCourse - course_id=52, school_id=2, fee_term=2, billing_cycle_days=30
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Route = admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token validated successfully for route: admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:51:22 --> CourseFeePlanModel::getFeeForCourse - course_id=52, school_id=2, fee_term=2, billing_cycle_days=30
WARNING - 2025-11-20 23:51:22 --> BillingScheduler::seedSchedule - Table t_billing_schedule does not exist. Skipping billing schedule creation.
WARNING - 2025-11-20 23:51:22 --> Failed to seed billing schedule: Billing schedule table not available
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:51:22 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:51:22 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:51:22 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:51:22 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:51:22 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:51:25 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:51:25 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:51:25 --> Class list results count: 215
DEBUG - 2025-11-20 23:51:25 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:54:05 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:54:05 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:54:05 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:54:05 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:54:05 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:54:05 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:54:05 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:54:05 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:54:05 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:54:05 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:54:05 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:54:05 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:54:05 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:54:05 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:54:05 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:05 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:05 --> Class list results count: 215
DEBUG - 2025-11-20 23:54:05 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:54:05 --> Class list results count: 215
DEBUG - 2025-11-20 23:54:05 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:54:06 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:54:13 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:13 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:13 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:18 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:54:18 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:18 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:19 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:20 --> AuthFilter: Route = admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:54:20 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:20 --> AuthFilter: Token validated successfully for route: admin/student-class/get-active-classes-for-course/\App\Controllers\Admin\StudentClass::getActiveClassesForCourse
DEBUG - 2025-11-20 23:54:25 --> AuthFilter: Route = admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:54:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:25 --> AuthFilter: Token validated successfully for route: admin/student-courses/update-status/\App\Controllers\Admin\StudentCourses::updateStatus
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:26 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:54:34 --> AuthFilter: Route = admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:54:34 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:34 --> AuthFilter: Token validated successfully for route: admin/student-courses/fee-preview/\App\Controllers\Admin\StudentCourses::feePreview
DEBUG - 2025-11-20 23:54:34 --> CourseFeePlanModel::getFeeForCourse - course_id=8, school_id=2, fee_term=2, billing_cycle_days=30
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Route = admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token validated successfully for route: admin/student-courses/add/\App\Controllers\Admin\StudentCourses::add
DEBUG - 2025-11-20 23:54:36 --> CourseFeePlanModel::getFeeForCourse - course_id=8, school_id=2, fee_term=2, billing_cycle_days=30
WARNING - 2025-11-20 23:54:36 --> BillingScheduler::seedSchedule - Table t_billing_schedule does not exist. Skipping billing schedule creation.
WARNING - 2025-11-20 23:54:36 --> Failed to seed billing schedule: Billing schedule table not available
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:54:36 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:54:36 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:54:36 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:54:36 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:54:36 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:54:38 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:54:38 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:54:38 --> Class list results count: 215
DEBUG - 2025-11-20 23:54:38 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:54:50 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:55:27 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:55:27 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:55:27 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:55:27 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:27 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:55:27 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:55:27 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:55:27 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:55:27 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:55:27 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:55:27 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:55:27 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:55:27 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:55:27 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:55:27 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:55:27 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:55:28 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:55:28 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:28 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:55:28 --> Class list results count: 215
DEBUG - 2025-11-20 23:55:28 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:55:28 --> Class list results count: 215
DEBUG - 2025-11-20 23:55:28 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:55:29 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:55:29 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:29 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:55:31 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:55:31 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:55:31 --> Class list results count: 215
DEBUG - 2025-11-20 23:55:31 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:55:33 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:55:33 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:33 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:55:34 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:55:34 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:55:34 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Route = admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Token validated successfully for route: admin/student-class/get-student-courses/\App\Controllers\Admin\StudentClass::getStudentCourses
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Route = admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:56:45 --> AuthFilter: Token validated successfully for route: admin/student-class/get-class-courses/\App\Controllers\Admin\StudentClass::getClassCourses
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:04 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:57:04 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:04 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:57:04 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:04 --> Class list results count: 215
DEBUG - 2025-11-20 23:57:04 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:57:04 --> Class list results count: 215
DEBUG - 2025-11-20 23:57:04 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:57:04 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:57:04 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:04 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:57:04 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:57:04 --> âœ… Guardians::list - Permission granted for student: 2477
DEBUG - 2025-11-20 23:57:04 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:57:04 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:57:04 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
ERROR - 2025-11-20 23:57:04 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
DEBUG - 2025-11-20 23:57:04 --> Found 3 transactions for student_id=2477 after filtering
WARNING - 2025-11-20 23:57:04 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:57:04 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:05 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:57:06 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:57:08 --> AuthFilter: Route = admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:57:08 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:08 --> AuthFilter: Token validated successfully for route: admin/student-courses/list/\App\Controllers\Admin\StudentCourses::list
DEBUG - 2025-11-20 23:57:10 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:57:10 --> Class list params: {"platform":"web","role_id":"2","user_id":"49","school_id":"2","type":"5","status":"1","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:10 --> Class list results count: 215
DEBUG - 2025-11-20 23:57:10 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Route = admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Route = crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token validated successfully for route: crm/fees/plans/\App\Controllers\Admin\Fees::listPlans
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token validated successfully for route: admin/self-registration/timeline/\App\Controllers\Admin\SelfRegistration::timeline
DEBUG - 2025-11-20 23:57:25 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:57:25 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:25 --> Class list query: SELECT DISTINCT `c`.`class_id`, `c`.`class_name`, `c`.`subject`, `c`.`grade`, `c`.`start_date`, `c`.`end_date`, `c`.`status`, `c`.`class_status`, `c`.`class_type`, `c`.`tags`, `c`.`class_code`, `c`.`batch_id`, `c`.`meeting_link`, `c`.`meeting_id`, `c`.`passcode`, `c`.`announcement_type`, `c`.`course_id`, COALESCE(tc.course_name, "") as course_name, (SELECT GROUP_CONCAT(subject_name) FROM subject WHERE FIND_IN_SET(subject_id, c.subject)) as subject_name, (SELECT GROUP_CONCAT(grade_name) FROM grade WHERE FIND_IN_SET(grade_id, c.grade)) as grade_name, (SELECT COUNT(*) FROM student_class sc 
                              WHERE sc.class_id = c.class_id AND sc.status = 1) as no_of_students, (SELECT GROUP_CONCAT(DISTINCT teacher_id) FROM class_schedule 
                              WHERE class_id = c.class_id) as teacher_ids, (SELECT CONCAT_WS(", ", GROUP_CONCAT(DISTINCT CONCAT_WS(" ", `up`.`first_name`, up.last_name)))
                              FROM class_schedule cs2
                              LEFT JOIN user_profile up ON FIND_IN_SET(up.user_id, cs2.teacher_id) > 0
                              WHERE cs2.class_id = c.class_id) as teacher_name
FROM `class` `c`
LEFT JOIN `tbl_course` `tc` ON `tc`.`course_id` = `c`.`course_id` AND `tc`.`entity_id` = `c`.`school_id`
WHERE `c`.`school_id` = '2'
AND `c`.`status` = '1'
ORDER BY `c`.`class_id` DESC
DEBUG - 2025-11-20 23:57:25 --> Class list params: {"platform":"web","type":"5","role_id":"2","user_id":"49","school_id":"2","teacher_id":"0","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Route = crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Route = student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token validated successfully for route: student/studentAllClassList/\App\Controllers\Student::studentAllClassList
DEBUG - 2025-11-20 23:57:25 --> AuthFilter: Token validated successfully for route: crm/guardians/list/\App\Controllers\Admin\Guardians::list
DEBUG - 2025-11-20 23:57:25 --> ðŸ“¥ Guardians::list - Payload: {"school_id":"2","student_id":"2477","timezone":"America\/New_York"}
DEBUG - 2025-11-20 23:57:25 --> âœ… Guardians::list - Token validated successfully. Token data: {"user_id":"49","role_id":"2","school_id":"2","timestamp":1763682050}
DEBUG - 2025-11-20 23:57:25 --> ðŸ“ Guardians::list - User ID: 49, School ID: 2, Is Admin: no
DEBUG - 2025-11-20 23:57:25 --> âœ… Guardians::list - Permission granted for student: 2477
ERROR - 2025-11-20 23:57:25 --> mysqli_sql_exception: Table 'edquill_production.students' doesn't exist in /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php:327
Stack trace:
#0 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/MySQLi/Connection.php(327): mysqli->query('SELECT `id`, `f...', 0)
#1 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(738): CodeIgniter\Database\MySQLi\Connection->execute('SELECT `id`, `f...')
#2 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseConnection.php(652): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT `id`, `f...')
#3 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Database/BaseBuilder.php(1649): CodeIgniter\Database\BaseConnection->query('SELECT `id`, `f...', Array, false)
#4 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Model.php(286): CodeIgniter\Database\BaseBuilder->get()
#5 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/BaseModel.php(675): CodeIgniter\Model->doFindAll(0, 0)
#6 /Applications/MAMP/htdocs/rista_ci4/app/Controllers/Admin/Guardians.php(139): CodeIgniter\BaseModel->findAll()
#7 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(933): App\Controllers\Admin\Guardians->list()
#8 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(507): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Admin\Guardians))
#9 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/CodeIgniter.php(354): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#10 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(334): CodeIgniter\CodeIgniter->run()
#11 /Applications/MAMP/htdocs/rista_ci4/vendor/codeigniter4/framework/system/Boot.php(67): CodeIgniter\Boot::runCodeIgniter(Object(CodeIgniter\CodeIgniter))
#12 /Applications/MAMP/htdocs/rista_ci4/public/index.php(63): CodeIgniter\Boot::bootWeb(Object(Config\Paths))
#13 {main}
WARNING - 2025-11-20 23:57:25 --> âš ï¸ Guardians::list - Unable to load student reference data: Table 'edquill_production.students' doesn't exist
DEBUG - 2025-11-20 23:57:25 --> âœ… Guardians::list - Returning 1 guardian(s)
DEBUG - 2025-11-20 23:57:26 --> Class list results count: 215
DEBUG - 2025-11-20 23:57:26 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:57:26 --> Class list results count: 215
DEBUG - 2025-11-20 23:57:26 --> First class: {"class_id":"1370","class_name":"New Test Class 2","subject":"20","grade":"57,55","start_date":"2025-11-11","end_date":"2025-12-06","status":"1","class_status":"0","class_type":"2","tags":"","class_code":"9964C81E","batch_id":"","meeting_link":"","meeting_id":"","passcode":"","announcement_type":"2","course_id":"52","course_name":"Grade 9 - Reading & Writing","subject_name":"Algebra 2","grade_name":"3,5","no_of_students":"8","teacher_ids":"1575,2116","teacher_name":"Daisy Admin,Hema  "}
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Route = crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Route = admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Route = admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token validated successfully for route: admin/self-registration/assignees/\App\Controllers\Admin\SelfRegistration::assignees
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token validated successfully for route: crm/fees/student-overview/\App\Controllers\Admin\Fees::studentOverview
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token validated successfully for route: admin/self-registration/list/\App\Controllers\Admin\SelfRegistration::list
DEBUG - 2025-11-20 23:57:26 --> Filtering transactions by school_id=2 for student_id=2477
DEBUG - 2025-11-20 23:57:26 --> Querying transactions: student_id=2477, school_id=2, filters={"school_id":2}. Total transactions in DB for this student: 3
DEBUG - 2025-11-20 23:57:26 --> Sample transactions in DB: [{"id":"1","student_id":"2477","school_id":"2","amount":"320.00","status":"cancelled","created_at":"2025-11-20 16:10:38"},{"id":"2","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 16:35:53"},{"id":"3","student_id":"2477","school_id":"2","amount":"320.00","status":"succeeded","created_at":"2025-11-20 19:29:08"}]
DEBUG - 2025-11-20 23:57:26 --> Found 3 transactions for student_id=2477 after filtering
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Route = student/attendanceDetail/\App\Controllers\Student::attendanceDetail
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token = eyJ0eXAiOiJKV1QiLCJh...
DEBUG - 2025-11-20 23:57:26 --> AuthFilter: Token validated successfully for route: student/attendanceDetail/\App\Controllers\Student::attendanceDetail
